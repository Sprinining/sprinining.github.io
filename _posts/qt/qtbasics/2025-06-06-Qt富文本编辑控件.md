---
title: Qtå¯Œæ–‡æœ¬ç¼–è¾‘æ§ä»¶
date: 2025-06-06 14:17:57 +0800
categories: [qt, qtbasics]
tags: [Qt]
description: "Qt å¯Œæ–‡æœ¬ç¼–è¾‘æ§ä»¶ QTextEdit æ”¯æŒå¤šæ ¼å¼æ–‡æœ¬ç¼–è¾‘ï¼Œæ˜¾ç¤ºå¯Œæ–‡æœ¬ï¼Œæ”¯æŒHTMLï¼Œå›¾ç‰‡å’Œæ ¼å¼åŒ–æ“ä½œã€‚"
---
## Qt å¯Œæ–‡æœ¬ç¼–è¾‘æ§ä»¶

### ç»§æ‰¿å…³ç³»å›¾

```css
QObject
â””â”€â”€ QWidget
    â”œâ”€â”€ QLineEdit
    â””â”€â”€ QFrame
        â””â”€â”€ QAbstractScrollArea
            â”œâ”€â”€ QPlainTextEdit
            â””â”€â”€ QTextEdit
                â””â”€â”€ QTextBrowser
```

### QFrame

`QFrame` æ˜¯ Qt æ¡†æ¶ä¸­çš„ä¸€ä¸ªåŸºç¡€æ§ä»¶ç±»ï¼Œç»§æ‰¿è‡ª `QWidget`ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ä¸ºç•Œé¢å…ƒç´ æä¾›ä¸€ä¸ªå¸¦è¾¹æ¡†çš„å®¹å™¨ï¼Œå¸¸ç”¨äºåˆ†éš”æˆ–åŒ…è£…å…¶ä»–æ§ä»¶ã€‚`QFrame` æ—¢å¯ä»¥ç‹¬ç«‹ä½¿ç”¨ï¼Œä¹Ÿç»å¸¸ä½œä¸ºå…¶ä»–æ§ä»¶ï¼ˆæ¯”å¦‚ `QGroupBox`ã€`QLabel`ï¼‰çš„åŸºç±»ã€‚

#### ä¸»è¦åŠŸèƒ½

**æ˜¾ç¤ºè¾¹æ¡†**ï¼š `QFrame` å¯ä»¥æ˜¾ç¤ºä¸åŒé£æ ¼çš„è¾¹æ¡†ï¼Œå¦‚çº¿å‹æ¡†ã€å‡¹é™·/å‡¸èµ·æ¡†ç­‰ã€‚

**åˆ†éš”å†…å®¹**ï¼š å¸¸ç”¨äºå¸ƒå±€ä¸­ä½œä¸ºåˆ†éš”çº¿ï¼ˆæ¨ªçº¿æˆ–ç«–çº¿ï¼‰ï¼Œèµ·åˆ°è§†è§‰ä¸Šçš„åˆ†éš”ä½œç”¨ã€‚

**åŒ…è£¹æ§ä»¶**ï¼š å¯ä»¥ä½œä¸ºå®¹å™¨åŒ…è£¹å…¶ä»–æ§ä»¶ï¼Œå¸¦ä¸Šç»Ÿä¸€çš„å¤–è§‚æ ·å¼ã€‚

#### å¸¸ç”¨å±æ€§å’Œæ–¹æ³•

##### è¾¹æ¡†æ ·å¼ç›¸å…³

```cpp
void setFrameStyle(int style);
int frameStyle() const;
```

- `frameStyle()` è®¾ç½®æ¡†çš„æ ·å¼ï¼Œç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š
  - çº¿æ¡æ ·å¼ï¼ˆShapeï¼‰ï¼šä¾‹å¦‚ `QFrame::Box`ã€`QFrame::Panel`ã€`QFrame::HLine`ã€`QFrame::VLine` ç­‰
  - é˜´å½±æ•ˆæœï¼ˆShadowï¼‰ï¼šä¾‹å¦‚ `QFrame::Plain`ã€`QFrame::Raised`ã€`QFrame::Sunken`

ä¾‹å¦‚ï¼š

```cpp
frame->setFrameStyle(QFrame::Panel | QFrame::Raised);
```

##### çº¿å®½å’Œä¸­çº¿å®½

```cpp
void setLineWidth(int width);
int lineWidth() const;

void setMidLineWidth(int width);
int midLineWidth() const;
```

- `lineWidth()` è®¾ç½®è¾¹æ¡†çº¿çš„å®½åº¦
- `midLineWidth()` ä»…å¯¹æŸäº›æ ·å¼ï¼ˆå¦‚ `QFrame::Panel`ï¼‰æœ‰æ•ˆï¼Œè¡¨ç¤ºä¸­é—´é˜´å½±çº¿å®½åº¦

#### å¸¸ç”¨å­ç±»

- `QLabel`ã€`QGroupBox` ç­‰æ§ä»¶éƒ½ç»§æ‰¿è‡ª `QFrame`ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å…¶è¾¹æ¡†åŠŸèƒ½ã€‚
- `QFrame` æœ¬èº«ä¸ä¼šæ˜¾ç¤ºæ–‡æœ¬æˆ–äº¤äº’å†…å®¹ï¼Œå¸¸ä¸å¸ƒå±€ç®¡ç†å™¨æˆ–å­æ§ä»¶é…åˆä½¿ç”¨ã€‚

#### ç¤ºä¾‹ä»£ç 

```cpp
QFrame *frame = new QFrame(this);
frame->setFrameStyle(QFrame::Box | QFrame::Raised);
frame->setLineWidth(2);
frame->setMidLineWidth(1);
frame->setFixedSize(200, 100);
```

#### ç”¨ä½œåˆ†éš”çº¿

```cpp
QFrame *line = new QFrame(this);
line->setFrameShape(QFrame::HLine);  // æ°´å¹³çº¿
line->setFrameShadow(QFrame::Sunken);
```

### QAbstractScrollArea

`QAbstractScrollArea` æ˜¯ Qt ä¸­ç”¨äºå®ç°**å¯æ»šåŠ¨åŒºåŸŸæ§ä»¶**çš„æŠ½è±¡åŸºç±»ï¼Œä½äº `QtWidgets` æ¨¡å—ä¸­ã€‚å®ƒä¸ºå…·æœ‰æ»šåŠ¨æ¡çš„ç•Œé¢æ§ä»¶ï¼ˆå¦‚ `QTextEdit`, `QTableView`, `QGraphicsView`, `QPlainTextEdit` ç­‰ï¼‰æä¾›äº†ç»Ÿä¸€çš„æ¡†æ¶æ”¯æŒã€‚

#### æ ¸å¿ƒæ¦‚å¿µ

`QAbstractScrollArea` æœ¬èº«ä¸ä¼šæ˜¾ç¤ºä»»ä½•å†…å®¹ï¼Œä½†å®ƒæä¾›äº†ä»¥ä¸‹ç»“æ„ï¼š

1. **è§†å£åŒºåŸŸï¼ˆviewportï¼‰**
    å†…å®¹çœŸæ­£ç»˜åˆ¶çš„åŒºåŸŸï¼Œæ˜¯ä¸€ä¸ª `QWidget*`ï¼Œå¯ä»¥é€šè¿‡ `viewport()` è·å–ã€‚
2. **æ»šåŠ¨æ¡ï¼ˆscroll barsï¼‰**
    æä¾›å‚ç›´/æ°´å¹³æ»šåŠ¨æ¡ï¼ˆ`QScrollBar* verticalScrollBar()` å’Œ `horizontalScrollBar()`ï¼‰ï¼Œå¹¶èƒ½è‡ªåŠ¨æ§åˆ¶å®ƒä»¬çš„æ˜¾ç¤º/éšè—ã€‚
3. **å†…å®¹åŒºç®¡ç†**
    æä¾›äº†å¤„ç†æ»šåŠ¨äº‹ä»¶ã€é¼ æ ‡äº‹ä»¶ã€é”®ç›˜äº‹ä»¶çš„æ¥å£ï¼Œä½¿å­ç±»å¯ä»¥å®ç°å¤æ‚çš„è‡ªå®šä¹‰æ»šåŠ¨é€»è¾‘ã€‚

#### å¸¸ç”¨æ¥å£

##### æ»šåŠ¨æ¡æ§åˆ¶

```cpp
QScrollBar* horizontalScrollBar() const;
QScrollBar* verticalScrollBar() const;
void setVerticalScrollBarPolicy(Qt::ScrollBarPolicy policy);
void setHorizontalScrollBarPolicy(Qt::ScrollBarPolicy policy);
```

> æ»šåŠ¨æ¡ç­–ç•¥åŒ…æ‹¬ï¼š
>
> - `Qt::ScrollBarAlwaysOn`ï¼šå§‹ç»ˆæ˜¾ç¤ºæ»šåŠ¨æ¡ï¼ˆå³ä½¿å†…å®¹ä¸æº¢å‡ºä¹Ÿæ˜¾ç¤ºï¼‰
> - `Qt::ScrollBarAlwaysOff`ï¼šå§‹ç»ˆéšè—æ»šåŠ¨æ¡ï¼ˆä¸å…è®¸ç”¨æˆ·æ»šåŠ¨ï¼‰
> - `Qt::ScrollBarAsNeeded`ï¼šæ ¹æ®éœ€è¦æ˜¾ç¤ºæ»šåŠ¨æ¡ï¼ˆå½“å†…å®¹è¶…å‡ºè§†å£æ—¶æ‰æ˜¾ç¤ºï¼‰

##### è§†å£ç›¸å…³

```cpp
QWidget* viewport() const;
void setViewport(QWidget* widget);
```

è§†å£ï¼ˆviewportï¼‰æ˜¯ç»˜åˆ¶å†…å®¹çš„åŒºåŸŸï¼Œæ‰€æœ‰å†…å®¹éƒ½åº”è¯¥ç»˜åˆ¶åœ¨è¿™ä¸ªåŒºåŸŸå†…ã€‚

##### äº‹ä»¶å¤„ç†ï¼ˆé€šå¸¸åœ¨å­ç±»ä¸­é‡å†™ï¼‰

```cpp
virtual void scrollContentsBy(int dx, int dy);
virtual void resizeEvent(QResizeEvent* event);
virtual void paintEvent(QPaintEvent* event);
virtual void mousePressEvent(QMouseEvent* event);
// ç­‰ç­‰
```

#### è‡ªå®šä¹‰å¯æ»šåŠ¨åŒºåŸŸ

```cpp
class MyScrollArea : public QAbstractScrollArea {
public:
    MyScrollArea(QWidget *parent = nullptr) {
        setViewport(new QWidget);
        // è®¾ç½®å†…å®¹å¤§å°ï¼Œæ‰‹åŠ¨æ§åˆ¶æ»šåŠ¨
        viewport()->setMinimumSize(1000, 1000);
    }

protected:
    void paintEvent(QPaintEvent* event) override {
        QPainter p(viewport());
        p.drawText(10, 20, "Hello Scroll Area");
    }

    void scrollContentsBy(int dx, int dy) override {
        viewport()->scroll(dx, dy);
    }
};
```

### QTextEdit

`QTextEdit` æ˜¯ Qt æä¾›çš„ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„**å¯Œæ–‡æœ¬ç¼–è¾‘æ§ä»¶**ï¼Œæ”¯æŒç¼–è¾‘å’Œæ˜¾ç¤º HTMLã€å¯Œæ–‡æœ¬ï¼ˆRich Textï¼‰ã€çº¯æ–‡æœ¬ï¼Œå¹¶å…·æœ‰å†…å»ºçš„æ»šåŠ¨æ¡å’Œå¤šç§æ–‡æœ¬æ ¼å¼æ§åˆ¶èƒ½åŠ›ã€‚å®ƒæ˜¯ç»§æ‰¿è‡ª `QAbstractScrollArea` çš„å­ç±»ï¼Œé€‚åˆç”¨äºéœ€è¦ç”¨æˆ·è¾“å…¥æˆ–å±•ç¤ºå¤§é‡æ ¼å¼åŒ–æ–‡æœ¬çš„åœºæ™¯ã€‚

#### å¸¸ç”¨æ„é€ å‡½æ•°

```cpp
QTextEdit(QWidget *parent = nullptr);
QTextEdit(const QString &text, QWidget *parent = nullptr); // è®¾ç½®åˆå§‹å†…å®¹
```

#### è®¾ç½®å’Œè·å–å†…å®¹

è®¾ç½®å†…å®¹

```cpp
textEdit->setPlainText("çº¯æ–‡æœ¬å†…å®¹");
textEdit->setHtml("<b>åŠ ç²—æ–‡æœ¬</b>");
```

è·å–å†…å®¹

```cpp
QString plain = textEdit->toPlainText();  // è·å–çº¯æ–‡æœ¬
QString html = textEdit->toHtml();        // è·å–å¯Œæ–‡æœ¬ï¼ˆHTML æ ¼å¼ï¼‰
```

#### æ–‡æœ¬æ ¼å¼è®¾ç½®

```cpp
textEdit->setFont(QFont("Courier New", 12));
textEdit->setTextColor(Qt::blue);
textEdit->setAlignment(Qt::AlignCenter);
```

ä¹Ÿå¯ä»¥ç”¨å…‰æ ‡å¯¹è±¡ (`QTextCursor`) ç²¾ç¡®æ§åˆ¶æ’å…¥å’Œæ ¼å¼ï¼š

```cpp
QTextCursor cursor = textEdit->textCursor();
cursor.insertText("æ’å…¥æ–‡å­—");
```

Qt `QTextEdit` æ–‡æœ¬æ ¼å¼æ§åˆ¶ç»¼åˆè¡¨ï¼š

| ğŸ¯ ä½œç”¨èŒƒå›´              | ğŸ¨ æ ¼å¼é¡¹     | ğŸ› ï¸ è®¾ç½®å‡½æ•°ï¼ˆæ‰€å±ç±»ï¼‰                           |
| ----------------------- | ------------ | ---------------------------------------------- |
| å­—ç¬¦ï¼ˆé€‰åŒºæˆ–å…‰æ ‡ï¼‰      | å­—ä½“         | `QTextCharFormat::setFont(QFont)`              |
|                         | å­—ä½“æ—       | `QTextCharFormat::setFontFamily(QString)`      |
|                         | å­—å·ï¼ˆç£…ï¼‰   | `QTextCharFormat::setFontPointSize(qreal)`     |
|                         | åŠ ç²—         | `QTextCharFormat::setFontWeight(int)`          |
|                         | æ–œä½“         | `QTextCharFormat::setFontItalic(bool)`         |
|                         | ä¸‹åˆ’çº¿       | `QTextCharFormat::setFontUnderline(bool)`      |
|                         | åˆ é™¤çº¿       | `QTextCharFormat::setFontStrikeOut(bool)`      |
|                         | å­—ä½“é¢œè‰²     | `QTextCharFormat::setForeground(QBrush)`       |
|                         | èƒŒæ™¯è‰²       | `QTextCharFormat::setBackground(QBrush)`       |
|                         | å­—é—´è·       | `QTextCharFormat::setFontLetterSpacing(qreal)` |
|                         | è¶…é“¾æ¥       | `setAnchor(true)` + `setAnchorHref(QString)`   |
|                         | åº”ç”¨å­—ç¬¦æ ·å¼ | `QTextCursor::mergeCharFormat(format)`         |
| æ–°è¾“å…¥æ–‡æœ¬ï¼ˆé»˜è®¤æ ¼å¼ï¼‰  | å­—ä½“é¢œè‰²     | `QTextEdit::setTextColor(QColor)`              |
|                         | å­—å·ï¼ˆç£…ï¼‰   | `QTextEdit::setFontPointSize(qreal)`           |
|                         | å½“å‰å­—ä½“     | `QTextEdit::setCurrentFont(QFont)`             |
| æ®µè½ï¼ˆå…‰æ ‡æ‰€åœ¨è¡Œ/é€‰æ®µï¼‰ | å¯¹é½æ–¹å¼     | `QTextEdit::setAlignment(Qt::AlignmentFlag)`   |

#### æ»šåŠ¨æ¡æ§åˆ¶ï¼ˆç»§æ‰¿è‡ª QAbstractScrollAreaï¼‰

```cpp
textEdit->setVerticalScrollBarPolicy(Qt::ScrollBarAsNeeded);
textEdit->setHorizontalScrollBarPolicy(Qt::ScrollBarAlwaysOff);
```

#### æŸ¥æ‰¾æ–‡æœ¬

```cpp
// å‘å‰æŸ¥æ‰¾ï¼ˆé»˜è®¤æ˜¯å‘åï¼‰
bool found = textEdit->find("ç›®æ ‡æ–‡æœ¬", QTextDocument::FindBackward);

// åŒºåˆ†å¤§å°å†™æŸ¥æ‰¾
bool found = textEdit->find("ç›®æ ‡æ–‡æœ¬", QTextDocument::FindCaseSensitively);

// å‘å‰æŸ¥æ‰¾ + åŒºåˆ†å¤§å°å†™
bool found = textEdit->find("ç›®æ ‡æ–‡æœ¬", 
                QTextDocument::FindBackward | QTextDocument::FindCaseSensitively);
```

æ”¯æŒæ–¹å‘æŸ¥æ‰¾ã€å¤§å°å†™æ•æ„Ÿç­‰é€‰é¡¹ã€‚

| æ ‡å¿—                  | å«ä¹‰               |
| --------------------- | ------------------ |
| `FindBackward`        | å‘æ–‡æ¡£å‰æ–¹å‘æŸ¥æ‰¾   |
| `FindCaseSensitively` | åŒºåˆ†å¤§å°å†™æŸ¥æ‰¾     |
| `FindWholeWords`      | å…¨å­—åŒ¹é…ï¼ˆéå­ä¸²ï¼‰ |

å¯ä»¥ä½¿ç”¨ `|` è¿ç®—ç¬¦ç»„åˆå¤šä¸ªæ ‡å¿—ã€‚

#### ç¼–è¾‘è¡Œä¸ºæ§åˆ¶

```cpp
textEdit->setReadOnly(true);      // è®¾ç½®åªè¯»
textEdit->setUndoRedoEnabled(true); // å¼€å¯æ’¤é”€é‡åš
textEdit->setWordWrapMode(QTextOption::WordWrap); // è®¾ç½®è‡ªåŠ¨æ¢è¡Œ
```

#### ç¤ºä¾‹ï¼šç®€æ˜“æ–‡æœ¬ç¼–è¾‘å™¨

##### widget.ui

```css
<?xml version="1.0" encoding="UTF-8"?>
<ui version="4.0">
 <class>Widget</class>
 <widget class="QWidget" name="Widget">
  <property name="geometry">
   <rect>
    <x>0</x>
    <y>0</y>
    <width>410</width>
    <height>300</height>
   </rect>
  </property>
  <property name="windowTitle">
   <string>Widget</string>
  </property>
  <widget class="QWidget" name="verticalLayoutWidget">
   <property name="geometry">
    <rect>
     <x>0</x>
     <y>10</y>
     <width>403</width>
     <height>221</height>
    </rect>
   </property>
   <layout class="QVBoxLayout" name="verticalLayout">
    <item>
     <layout class="QHBoxLayout" name="horizontalLayout">
      <item>
       <widget class="QPushButton" name="btnBold">
        <property name="text">
         <string>ç²—ä½“</string>
        </property>
       </widget>
      </item>
      <item>
       <widget class="QPushButton" name="btnItalic">
        <property name="text">
         <string>æ–œä½“</string>
        </property>
       </widget>
      </item>
      <item>
       <widget class="QPushButton" name="btnUnderline">
        <property name="text">
         <string>ä¸‹åˆ’çº¿</string>
        </property>
       </widget>
      </item>
      <item>
       <widget class="QPushButton" name="btnColor">
        <property name="text">
         <string>å‰æ™¯è‰²</string>
        </property>
       </widget>
      </item>
      <item>
       <widget class="QPushButton" name="btnBGColor">
        <property name="text">
         <string>èƒŒæ™¯è‰²</string>
        </property>
       </widget>
      </item>
     </layout>
    </item>
    <item>
     <layout class="QHBoxLayout" name="horizontalLayout_2">
      <item>
       <widget class="QLabel" name="lblFontSize">
        <property name="text">
         <string>å­—å·</string>
        </property>
       </widget>
      </item>
      <item>
       <widget class="QLineEdit" name="edtFontSize"/>
      </item>
      <item>
       <widget class="QLabel" name="lblFontBox">
        <property name="text">
         <string>å­—ä½“</string>
        </property>
       </widget>
      </item>
      <item>
       <widget class="QFontComboBox" name="fontBox"/>
      </item>
     </layout>
    </item>
    <item>
     <widget class="QTextEdit" name="txtEdt"/>
    </item>
   </layout>
  </widget>
 </widget>
 <resources/>
 <connections/>
</ui>
```

##### widget.h

```cpp
#ifndef WIDGET_H
#define WIDGET_H

#include <QTextCharFormat> // æ–‡æœ¬æ ¼å¼ç±»
#include <QWidget>

QT_BEGIN_NAMESPACE
namespace Ui {
class Widget;
}
QT_END_NAMESPACE

class Widget : public QWidget {
    Q_OBJECT

public:
    Widget(QWidget* parent = nullptr);
    ~Widget();

private slots:
    void on_btnItalic_clicked(bool checked);
    void on_btnBold_clicked(bool checked);
    void on_btnUnderline_clicked(bool checked);
    void on_btnColor_clicked();
    void on_btnBGColor_clicked();
    void on_edtFontSize_editingFinished();
    void on_txtEdt_currentCharFormatChanged(const QTextCharFormat& format);
    void on_txtEdt_textChanged();

private:
    Ui::Widget* ui;
};
#endif // WIDGET_H
```

##### widget.cpp

```cpp
#include "widget.h"
#include "./ui_widget.h"
#include <QColorDialog>

Widget::Widget(QWidget* parent) : QWidget(parent), ui(new Ui::Widget) {
    ui->setupUi(this);

    // è®¾ç½®æŒ‰é’®ä¸ºå¯åˆ‡æ¢çŠ¶æ€ï¼ˆç‚¹å‡»åå¯ä¿æŒæŒ‰ä¸‹æˆ–å¼¹èµ·ï¼‰
    ui->btnBold->setCheckable(true);
    ui->btnItalic->setCheckable(true);
    ui->btnUnderline->setCheckable(true);

    // è®¾ç½®å­—å·è¾“å…¥æ¡†ä¸ºåªèƒ½è¾“å…¥ 0~72 çš„æ•´æ•°
    QIntValidator* vali = new QIntValidator(0, 72);
    ui->edtFontSize->setValidator(vali);

    // è®¾ç½®é»˜è®¤å­—å·ä¸º 9
    ui->edtFontSize->setText(QString::number(9));

    // å­—ä½“ä¸‹æ‹‰æ¡†å†…å®¹å˜åŒ–æ—¶è®¾ç½® QTextEdit çš„å­—ä½“å®¶æ—ï¼ˆç”¨æˆ·é€‰æ‹©å­—ä½“æ—¶è§¦å‘ï¼‰
    connect(ui->fontBox, &QFontComboBox::currentTextChanged, ui->txtEdt, &QTextEdit::setFontFamily);

    // åˆå§‹åŒ–å¯Œæ–‡æœ¬å†…å®¹ï¼ˆæ˜¾ç¤ºå„ç§å­—ä½“æ•ˆæœï¼‰
    ui->txtEdt->setHtml("<b>ç²—ä½“å­—çš„è¡Œ<br></b>"
                        "<i>æ–œä½“å­—çš„è¡Œ<br></i>"
                        "<u>ä¸‹åˆ’çº¿çš„è¡Œ<br></u>"
                        "<font style=\"color:red;\">æ–‡æœ¬å‰æ™¯è‰²<br></font>"
                        "<font style=\"background:yellow;\">æ–‡å­—èƒŒæ™¯è‰²<br></font>"
                        "<font style=\"font-size:18pt;\">å­—å·å¤§å°å˜åŒ–çš„è¡Œ<br></font>"
                        "<font style=\"font-family:é»‘ä½“;\">å­—ä½“å®¶æ—å˜åŒ–çš„è¡Œ<br></font>");
}

Widget::~Widget() {
    delete ui;
}

// âœ” ç²—ä½“æŒ‰é’®ç‚¹å‡»æ—¶è§¦å‘ï¼ˆæ— è®ºæ˜¯ç”¨æˆ·ç‚¹å‡»æˆ–ä»£ç  setChecked éƒ½ä¼šè§¦å‘ï¼‰
void Widget::on_btnBold_clicked(bool checked) {
    if (checked)
        ui->txtEdt->setFontWeight(QFont::Bold);
    else
        ui->txtEdt->setFontWeight(QFont::Normal);
}

// âœ” æ–œä½“æŒ‰é’®ç‚¹å‡»æ—¶è§¦å‘ï¼ˆè®¾ç½®å½“å‰å­—ä½“æ˜¯å¦ä¸ºæ–œä½“ï¼‰
void Widget::on_btnItalic_clicked(bool checked) {
    ui->txtEdt->setFontItalic(checked);
}

// âœ” ä¸‹åˆ’çº¿æŒ‰é’®ç‚¹å‡»æ—¶è§¦å‘ï¼ˆè®¾ç½®å½“å‰å­—ä½“æ˜¯å¦æœ‰ä¸‹åˆ’çº¿ï¼‰
void Widget::on_btnUnderline_clicked(bool checked) {
    ui->txtEdt->setFontUnderline(checked);
}

// âœ” å½“å‰æ§½å‡½æ•°åœ¨ç‚¹å‡»â€œå‰æ™¯è‰²â€æŒ‰é’®æ—¶è§¦å‘ï¼ˆå³æŒ‰é’®çš„ clicked() ä¿¡å·ï¼‰
// åŠŸèƒ½ï¼šå¼¹å‡ºé¢œè‰²é€‰æ‹©å¯¹è¯æ¡†ï¼Œè·å–ç”¨æˆ·é€‰å–çš„é¢œè‰²ï¼Œ
// å¦‚æœé¢œè‰²æœ‰æ•ˆï¼Œåˆ™å°†è¯¥é¢œè‰²è®¾ç½®ä¸º QTextEdit å½“å‰é€‰ä¸­æ–‡æœ¬ï¼ˆæˆ–å…‰æ ‡å¤„åç»­è¾“å…¥ï¼‰çš„å‰æ™¯è‰²ï¼ˆæ–‡å­—é¢œè‰²ï¼‰
// åŒæ—¶ï¼ŒæŠŠè¯¥é¢œè‰²åŒæ­¥æ˜¾ç¤ºåœ¨æŒ‰é’®çš„èƒŒæ™¯ä¸Šï¼Œä½œä¸ºè§†è§‰æç¤º
void Widget::on_btnColor_clicked() {
    // å¼¹å‡º QColorDialog é¢œè‰²é€‰æ‹©å¯¹è¯æ¡†ï¼Œé»˜è®¤é¢œè‰²ä¸ºé»‘è‰²
    QColor clr = QColorDialog::getColor(Qt::black);

    // åˆ¤æ–­ç”¨æˆ·æ˜¯å¦é€‰æ‹©äº†æœ‰æ•ˆé¢œè‰²ï¼ˆç‚¹å‡»â€œå–æ¶ˆâ€åˆ™é¢œè‰²æ— æ•ˆï¼‰
    if (clr.isValid()) {
        // è®¾ç½® QTextEdit ä¸­å½“å‰å…‰æ ‡æ‰€åœ¨ä½ç½®ï¼ˆæˆ–é€‰ä¸­æ–‡æœ¬ï¼‰çš„å‰æ™¯è‰²ä¸ºç”¨æˆ·é€‰æ‹©çš„é¢œè‰²
        // å¦‚æœæ²¡æœ‰é€‰ä¸­æ–‡æœ¬ï¼Œåˆ™è®¾ç½®çš„æ˜¯â€œæ’å…¥æ ¼å¼â€ï¼Œå³åç»­è¾“å…¥çš„æ–‡å­—å°†é‡‡ç”¨è¯¥é¢œè‰²
        ui->txtEdt->setTextColor(clr);

        // æ„é€ ç”¨äºè®¾ç½®æŒ‰é’®æ ·å¼çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ "color: #ff0000"
        QString str = tr("color: %1").arg(clr.name());

        // è®¾ç½®æŒ‰é’®çš„æ ·å¼ï¼Œä½¿æŒ‰é’®ä¸Šæ˜¾ç¤ºçš„é¢œè‰²å’Œé€‰ä¸­çš„å‰æ™¯è‰²ä¿æŒä¸€è‡´ï¼ˆå¢å¼ºäº¤äº’æ„Ÿï¼‰
        ui->btnColor->setStyleSheet(str);
    }
}

// âœ” èƒŒæ™¯è‰²æŒ‰é’®ç‚¹å‡»æ—¶è§¦å‘ï¼ˆå¼¹å‡ºé¢œè‰²é€‰æ‹©å¯¹è¯æ¡†ï¼Œè®¾ç½®å­—ä½“èƒŒæ™¯è‰²ï¼‰
void Widget::on_btnBGColor_clicked() {
    QColor bgclr = QColorDialog::getColor(Qt::white);
    if (bgclr.isValid()) {
        ui->txtEdt->setTextBackgroundColor(bgclr);
        // åŒæ­¥æŒ‰é’®é¢œè‰²æ ·å¼æ˜¾ç¤º
        QString str = tr("background: %1").arg(bgclr.name());
        ui->btnBGColor->setStyleSheet(str);
    }
}

// âœ” ç”¨æˆ·åœ¨å­—ä½“å¤§å°è¾“å…¥æ¡†ä¸­ç¼–è¾‘å®Œæˆï¼ˆæŒ‰ä¸‹ Enter æˆ–ç„¦ç‚¹ç§»å‡ºï¼‰æ—¶è§¦å‘
void Widget::on_edtFontSize_editingFinished() {
    int fontSize = ui->edtFontSize->text().toInt();
    ui->txtEdt->setFontPointSize(fontSize);
}

// âœ” QTextEdit ä¸­æ–‡æœ¬å…‰æ ‡ä½ç½®å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘ï¼ˆç”¨äºåŒæ­¥æ›´æ–°æŒ‰é’®çŠ¶æ€å’Œæ ·å¼ï¼‰
void Widget::on_txtEdt_currentCharFormatChanged(const QTextCharFormat& format) {
    // åŒæ­¥åŠ ç²—æŒ‰é’®çŠ¶æ€
    if (format.fontWeight() == QFont::Bold)
        ui->btnBold->setChecked(true);
    else
        ui->btnBold->setChecked(false);

    // åŒæ­¥æ–œä½“ã€ä¸‹åˆ’çº¿æŒ‰é’®çŠ¶æ€
    ui->btnItalic->setChecked(format.fontItalic());
    ui->btnUnderline->setChecked(format.fontUnderline());

    // å½“ QTextEdit çš„å…‰æ ‡ä½ç½®å˜åŒ–ï¼Œæˆ–é€‰ä¸­çš„å­—ç¬¦æ ¼å¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ›´æ–°â€œå‰æ™¯è‰²â€æŒ‰é’®çš„æ ·å¼æ˜¾ç¤ºï¼Œä½¿å…¶åæ˜ å½“å‰æ–‡å­—çš„å‰æ™¯è‰²ï¼ˆå­—ä½“é¢œè‰²ï¼‰
    // è·å–å½“å‰å­—ç¬¦æ ¼å¼ä¸­çš„å‰æ™¯è‰²ä¿¡æ¯ï¼ˆå³æ–‡å­—é¢œè‰²ï¼‰
    // foreground() è¿”å›çš„æ˜¯ä¸€ä¸ª QBrush ç±»å‹ï¼Œå¯èƒ½åŒ…å«é¢œè‰²ã€æ¸å˜ç­‰ä¿¡æ¯
    QBrush brushText = format.foreground();

    // åˆ¤æ–­ brushText æ˜¯å¦æœ‰æ•ˆï¼ˆéç©ºç”»åˆ·ï¼‰
    // Qt::NoBrush è¡¨ç¤ºæœªè®¾ç½®é¢œè‰²ï¼›æ­¤å¤„è¦é¿å…åœ¨æŒ‰é’®ä¸Šæ˜¾ç¤ºæ— æ•ˆé¢œè‰²
    if (brushText != Qt::NoBrush) {
        // æå–ç”»åˆ·ä¸­çš„é¢œè‰²å€¼ï¼ˆQColor ç±»å‹ï¼‰
        QColor clrText = brushText.color();

        // æ„é€ ç”¨äºè®¾ç½®æŒ‰é’®æ ·å¼çš„å­—ç¬¦ä¸²ï¼Œå¦‚ "color: #ff0000"
        // è¿™é‡Œä½¿ç”¨çš„æ˜¯ CSS æ ·å¼æ ¼å¼ï¼Œè®©æŒ‰é’®æ–‡å­—é¢œè‰²ä¸å½“å‰å…‰æ ‡æ–‡æœ¬é¢œè‰²ä¸€è‡´
        QString str = tr("color: %1").arg(clrText.name());

        // è®¾ç½®â€œå‰æ™¯è‰²â€æŒ‰é’®çš„æ ·å¼ï¼Œä½¿å…¶æ˜¾ç¤ºå½“å‰å­—ä½“é¢œè‰²ï¼ˆæ–‡å­—å˜è‰²ï¼Œå¢å¼ºäº¤äº’ä½“éªŒï¼‰
        ui->btnColor->setStyleSheet(str);
    } else {
        // å¦‚æœæ²¡æœ‰è®¾ç½®å‰æ™¯è‰²ï¼ˆä¾‹å¦‚é»˜è®¤æ ·å¼ï¼‰ï¼Œåˆ™æ¸…ç©ºæŒ‰é’®æ ·å¼ï¼Œä½¿å…¶æ¢å¤åŸçŠ¶
        ui->btnColor->setStyleSheet("");
    }

    // æ›´æ–°èƒŒæ™¯è‰²æŒ‰é’®æ˜¾ç¤ºæ ·å¼
    QBrush brushBG = format.background();
    if (brushBG != Qt::NoBrush) {
        QColor clrBG = brushBG.color();
        QString str = tr("background: %1").arg(clrBG.name());
        ui->btnBGColor->setStyleSheet(str);
    } else {
        ui->btnBGColor->setStyleSheet("");
    }

    // åŒæ­¥å­—ä½“å¤§å°åˆ°è¾“å…¥æ¡†
    QFont curFont = format.font();
    int fontSize = curFont.pointSize();
    if (-1 == fontSize) fontSize = (int)(curFont.pixelSize() * 9.0 / 12.0); // å…¼å®¹æŸäº›æ ¼å¼
    ui->edtFontSize->setText(QString::number(fontSize));

    // åŒæ­¥å­—ä½“å®¶æ—åˆ°ä¸‹æ‹‰æ¡†
    QString strFontFamily = curFont.family();
    ui->fontBox->setCurrentText(strFontFamily);
}

// âœ” QTextEdit æ–‡æœ¬å˜åŒ–æ—¶è§¦å‘ï¼ˆå†…å®¹æœ‰ä»»ä½•ç¼–è¾‘éƒ½ä¼šè°ƒç”¨ï¼Œä¸»è¦ç”¨äºè°ƒè¯•ï¼‰
void Widget::on_txtEdt_textChanged() {
    qDebug() << ui->txtEdt->toHtml() << Qt::endl;
}
```

å½“å‰çš„ä»£ç ä¸­ï¼Œæ‰€æœ‰è°ƒç”¨è¯¸å¦‚ `setFontItalic`ã€`setFontWeight`ã€`setTextColor`ã€`setFontPointSize` ç­‰æ–¹æ³•ï¼Œ**ä½œç”¨å¯¹è±¡æ˜¯ QTextEdit çš„â€œå…‰æ ‡å½“å‰é€‰ä¸­çš„æ–‡æœ¬â€**ã€‚

Qt ä¸­çš„ `QTextEdit` æä¾›è¿™ç±»æ–¹æ³•æ—¶ï¼Œéƒ½æ˜¯**åŸºäºå½“å‰ QTextCursor çš„é€‰æ‹©èŒƒå›´**è¿›è¡Œè®¾ç½®çš„ã€‚

ä¾‹å¦‚ï¼š

- `ui->txtEdt->setFontItalic(true);`
- `ui->txtEdt->setTextColor(clr);`
- `ui->txtEdt->setFontPointSize(18);`

è¿™äº›æ–¹æ³•çš„è¡Œä¸ºæ˜¯ï¼š

> å¦‚æœæœ‰é€‰ä¸­çš„æ–‡æœ¬ï¼Œå°±ä¿®æ”¹é€‰ä¸­éƒ¨åˆ†çš„æ ¼å¼ï¼›
>  å¦‚æœæ²¡æœ‰é€‰ä¸­ä»»ä½•æ–‡æœ¬ï¼Œå°±è®¾ç½®â€œå½“å‰å…‰æ ‡ä½ç½®åè¾“å…¥çš„æ–‡æœ¬â€çš„æ ¼å¼ï¼ˆæ’å…¥ç¬¦å·æ ·å¼ï¼‰ï¼Œä½†**ä¸ä¼šå½±å“å·²æœ‰æ–‡æœ¬**ã€‚

### QTextBrowser

#### ä¸ QTextEdit çš„ä¸»è¦åŒºåˆ«

| ç‰¹æ€§       | QTextEdit                  | QTextBrowser                           |
| ---------- | -------------------------- | -------------------------------------- |
| ç»§æ‰¿å…³ç³»   | åŸºç±»                       | ç»§æ‰¿è‡ª QTextEdit                       |
| ä¸»è¦åŠŸèƒ½   | æ–‡æœ¬ç¼–è¾‘ï¼ˆæ”¯æŒå¯Œæ–‡æœ¬æ ¼å¼ï¼‰ | å¯Œæ–‡æœ¬æµè§ˆï¼ˆåªè¯»ï¼Œå¸¦è¶…é“¾æ¥æ”¯æŒï¼‰       |
| æ˜¯å¦å¯ç¼–è¾‘ | é»˜è®¤å¯ç¼–è¾‘                 | é»˜è®¤åªè¯»                               |
| æ”¯æŒçš„å†…å®¹ | æ”¯æŒæ–‡æœ¬è¾“å…¥å’Œç¼–è¾‘         | æ”¯æŒå¯Œæ–‡æœ¬æ˜¾ç¤ºï¼Œè¶…é“¾æ¥è‡ªåŠ¨å¤„ç†         |
| æµè§ˆåŠŸèƒ½   | æ— æµè§ˆå†å²ã€æ— å‰è¿›åé€€å¯¼èˆª | æ”¯æŒè¶…é“¾æ¥å¯¼èˆªã€å†å²è®°å½•ã€å‰è¿›åé€€åŠŸèƒ½ |
| è¶…é“¾æ¥æ”¯æŒ | éœ€è¦è‡ªå·±å¤„ç†               | å†…ç½®å¯¹è¶…é“¾æ¥çš„è‡ªåŠ¨å¤„ç†å’Œæ‰“å¼€æ”¯æŒ       |
| åº”ç”¨åœºæ™¯   | æ–‡æœ¬ç¼–è¾‘å™¨ã€å¯Œæ–‡æœ¬ç¼–è¾‘æ§ä»¶ | HTML å†…å®¹æµè§ˆå™¨ã€å¸®åŠ©æ–‡æ¡£æŸ¥çœ‹å™¨        |

#### ç¤ºä¾‹ï¼šç®€æ˜“ HTML æŸ¥çœ‹å™¨

##### widget.h

```cpp
#ifndef WIDGET_H
#define WIDGET_H

#include <QWidget>

QT_BEGIN_NAMESPACE
namespace Ui {
class Widget;
}
QT_END_NAMESPACE

class Widget : public QWidget {
    Q_OBJECT

public:
    Widget(QWidget* parent = nullptr);
    ~Widget();

private slots:
    void on_btnOpen_clicked();
    void on_textBrowser_backwardAvailable(bool arg1);
    void on_textBrowser_forwardAvailable(bool arg1);
    void on_textBrowser_textChanged();

private:
    Ui::Widget* ui;
};
#endif // WIDGET_H
```

##### widget.cpp

```cpp
#include "widget.h"
#include "./ui_widget.h"
#include <QFileDialog>
#include <QUrl>

// æ„é€ å‡½æ•°ï¼šåˆå§‹åŒ– UI ç»„ä»¶å¹¶è¿æ¥ä¿¡å·ä¸æ§½å‡½æ•°
Widget::Widget(QWidget* parent) : QWidget(parent), ui(new Ui::Widget) {
    ui->setupUi(this); // è®¾ç½® UI

    ui->plainTextEdit->setReadOnly(true);        // è®¾ç½® plainTextEdit ä¸ºåªè¯»ï¼Œç”¨äºæ˜¾ç¤º HTML æºç 
    ui->textBrowser->setOpenExternalLinks(true); // å¯ç”¨è¶…é“¾æ¥çš„å¤–éƒ¨æ‰“å¼€åŠŸèƒ½ï¼ˆåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼‰
    ui->btnBackward->setEnabled(false);          // åˆå§‹åŒ–æ—¶â€œåé€€â€æŒ‰é’®ç¦ç”¨
    ui->btnForward->setEnabled(false);           // åˆå§‹åŒ–æ—¶â€œå‰è¿›â€æŒ‰é’®ç¦ç”¨

    // è¿æ¥æŒ‰é’®ç‚¹å‡»ä¿¡å·ä¸ QTextBrowser çš„åé€€/å‰è¿›æ§½å‡½æ•°
    connect(ui->btnBackward, &QPushButton::clicked, ui->textBrowser, &QTextBrowser::backward);
    connect(ui->btnForward, &QPushButton::clicked, ui->textBrowser, &QTextBrowser::forward);
}

// ææ„å‡½æ•°ï¼šé‡Šæ”¾ UI èµ„æº
Widget::~Widget() {
    delete ui;
}

// æ‰“å¼€æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼šé€‰æ‹© HTML æ–‡ä»¶å¹¶åŠ è½½åˆ° QTextBrowser ä¸­
void Widget::on_btnOpen_clicked() {
    // ä½¿ç”¨ QFileDialog æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼Œè·å–ç”¨æˆ·é€‰æ‹©çš„ HTML æ–‡ä»¶çš„ URL
    // å‚æ•°è¯´æ˜ï¼š
    // 1. thisï¼šçˆ¶çª—å£æŒ‡é’ˆï¼ŒæŒ‡å®šè¿™ä¸ªå¯¹è¯æ¡†çš„çˆ¶å¯¹è±¡ä¸ºå½“å‰ Widgetï¼Œç¡®ä¿å¯¹è¯æ¡†åœ¨å½“å‰çª—å£ä¹‹ä¸Šå¼¹å‡º
    // 2. "open HTML"ï¼šå¯¹è¯æ¡†æ ‡é¢˜ï¼Œç”¨äºæç¤ºç”¨æˆ·å½“å‰æ“ä½œæ˜¯â€œæ‰“å¼€ HTML æ–‡ä»¶â€
    // 3. QUrl()ï¼šåˆå§‹è·¯å¾„ï¼Œä¼ å…¥ç©º QUrl è¡¨ç¤ºä½¿ç”¨é»˜è®¤ç›®å½•ï¼ˆå¯ç”¨ QUrl::fromLocalFile("è·¯å¾„") æŒ‡å®šåˆå§‹ç›®å½•ï¼‰
    // 4. "HTML files(*.htm *.html)"ï¼šè¿‡æ»¤å™¨å­—ç¬¦ä¸²ï¼Œä»…æ˜¾ç¤º *.htm å’Œ *.html åç¼€çš„æ–‡ä»¶
    QUrl urlFile = QFileDialog::getOpenFileUrl(this, "open HTML", QUrl(), "HTML files(*.htm *.html)");

    // åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å®é™…é€‰æ‹©äº†æ–‡ä»¶ï¼ˆå³è¿”å›çš„ URL éç©ºï¼‰
    if (!urlFile.isEmpty()) {
        qDebug() << urlFile;                 // è¾“å‡ºé€‰æ‹©çš„æ–‡ä»¶ URLï¼Œç”¨äºè°ƒè¯•
        ui->textBrowser->setSource(urlFile); // å°†é€‰æ‹©çš„ HTML æ–‡ä»¶åŠ è½½åˆ° QTextBrowser ä¸­æ˜¾ç¤º
    }
}

// å½“ textBrowser å¯ä»¥åé€€æ—¶ï¼Œå¯ç”¨â€œåé€€â€æŒ‰é’®
void Widget::on_textBrowser_backwardAvailable(bool arg1) {
    ui->btnBackward->setEnabled(arg1);
}

// å½“ textBrowser å¯ä»¥å‰è¿›æ—¶ï¼Œå¯ç”¨â€œå‰è¿›â€æŒ‰é’®
void Widget::on_textBrowser_forwardAvailable(bool arg1) {
    ui->btnForward->setEnabled(arg1);
}

// å½“ textBrowser å†…å®¹å˜åŒ–æ—¶ï¼Œæ›´æ–° plainTextEdit æ˜¾ç¤º HTML æºç 
void Widget::on_textBrowser_textChanged() {
    QString strHtml = ui->textBrowser->toHtml(); // è·å– HTML å†…å®¹
    ui->plainTextEdit->setPlainText(strHtml);    // æ˜¾ç¤ºåœ¨ plainTextEdit ä¸­
}
```

